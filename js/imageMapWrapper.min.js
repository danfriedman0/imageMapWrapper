!function(t){function a(a,c){var l=a.width,d=a.height,h=t(a),p=h.attr("src"),u=h.attr("usemap").slice(1),f=t("map[name="+u+"]");e(l,d,h,p,u,f),i(h),n(f,c),r(f),o(u),s()}function e(a,e,i,n,r,o){var s=i.attr("id")+"Wrapper";i.wrap('<div id = "'+s+'" width="'+a+'" height="'+e+'" class="imw-wrapper" style="display: inline-block; position: relative; line-height: 0; max-width: 100%; height: auto">'),t("#"+s).append('<canvas id="'+r+'Canvas" class="imw-canvas" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 10; pointer-events: none;"></canvas>').append('<img id ="'+r+'Clone" class="imw-clone" src="'+n+'" style="visibility: hidden; width: 100%; height: auto">'),o.addClass("imw-map")}function i(t){t.addClass("imw-image").css({position:"absolute",top:"0",left:"0",height:"auto"}),t.css("max-width","100%")}function n(t,a){t.data("_settings",a)}function r(a){a.find("area").each(function(){var a=this.coords.split(",").map(function(t){return parseInt(t,10)});t(this).data("startCoords",a)})}function o(a){t("map[name="+a+"] area").mouseover(function(){p(t(this))}).mouseleave(function(){h(t(this))}),t(window).resize(d(s))}function s(){c(),l()}function c(){t(".imw-canvas").each(function(){var a=t(this).closest(".imw-wrapper")[0],e=a.getBoundingClientRect().width,i=a.getBoundingClientRect().height,n=this.getContext("2d");n.canvas.width=e,n.canvas.height=i})}function l(){t(".imw-map").each(function(){var a=t('img[usemap="#'+this.name+'"]')[0],e=a.width/a.naturalWidth;t(this).find("area").each(function(){var a=t(this).data("startCoords");a=a.map(function(t){return t*e}),this.coords=a.join(",")})})}function d(t,a){var e,a=a||200;return function(){var i=this,n=arguments;clearTimeout(e),e=setTimeout(function(){t.apply(i,Array.prototype.slice.call(n))},a)}}function h(a){var e=a.parent().attr("name"),i=t("#"+e+"Canvas")[0],n=i.getContext("2d");n.clearRect(0,0,i.width,i.height)}function p(a){var e=a.parent(),i=a.attr("coords").split(",").map(function(t){return parseInt(t,10)}),n=a.attr("shape"),r=e.attr("name"),o=e.data("_settings");if(o.useAreaSettings){var s=a.data("settings");s&&(s=JSON.parse(s.replace(/\'/g,'"')),o=t.extend({},o,s))}var c=t("#"+r+"Canvas")[0].getContext("2d");switch(c.globalAlpha=o.fillOpacity,c.fillStyle=o.fillColor,o.border&&(c.lineWidth=o.borderWidth,c.strokeStyle=o.borderColor),n){case"poly":u(i,c,o);break;case"circle":f(i,c,o);break;case"rect":g(i,c,o)}}function u(t,a,e){a.beginPath();var i,n;i=t[0],n=t[1],a.moveTo(i,n);for(var r=2;r<t.length;r+=2)i=t[r],n=t[r+1],a.lineTo(i,n);a.closePath(),a.fill(),e.border&&(a.globalAlpha=e.borderOpacity,a.stroke())}function f(t,a,e){a.beginPath(),a.arc(t[0],t[1],t[2],0,2*Math.PI,!1),a.fill(),e.border&&(a.globalAlpha=e.borderOpacity,a.stroke())}function g(t,a,e){var i=t[0],n=t[1],r=t[2]-t[0],o=t[3]-t[1];a.fillRect(i,n,r,o),e.border&&(a.globalAlpha=e.borderOpacity,a.strokeRect(i,n,r,o))}t.fn.imageMapWrapper=function(e){var i=t.extend({},t.fn.imageMapWrapper.defaults,e);return this.filter("img[usemap]").each(function(){a(this,i)})},t.fn.imageMapWrapper.resize=s,t.fn.imageMapWrapper.defaults={fillColor:"#fff",fillOpacity:.7,border:!1,borderWidth:2,borderColor:"#f00",borderOpacity:1,useAreaSettings:!1}}(jQuery);